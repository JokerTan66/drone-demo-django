{% extends "layouts/base.html" %}

{% block title %} 设备列表 {% endblock %}

{% block stylesheets %}
<style>
    body {
        margin: 0;
        overflow-x: hidden;
    }
    .video-background {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        object-fit: cover;
    }
    .content {
        margin-top: 100px; /* 顶部距离 */
        position: relative;
    }
    .device-card {
        background-color: rgba(255, 255, 255, 0.8);
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        margin: 20px auto;
        padding: 20px;
        width: 50%;
        min-width: 300px;
        text-align: left;
    }
    .device-table {
        width: 100%;
        border-collapse: collapse;
    }
    .device-table th, .device-table td {
        padding: 8px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }
    .device-table th {
        background-color: #f2f2f2;
    }
    .floating-button {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background-color: #007bff;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        cursor: pointer;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .modal-content {
        background-color: #f8f9fa;
    }
</style>
{% endblock stylesheets %}

{% block content %}
<!-- 背景视频 -->
<video class="video-background" autoplay loop muted>
    <source src="{{ ASSETS_ROOT }}/img/bgv.mp4" type="video/mp4">
    您的浏览器不支持视频标签。
</video>

<div class="content">
    <div class="container">
        <h2 class="text-center">设备列表</h2>
        {% for device in devices %}
        <div class="device-card">
            <h3>设备详情</h3>
            <table class="device-table">
                <tr>
                    <th>无人机型号</th>
                    <td>{{ device.drone_model }}</td>
                </tr>
                <tr>
                    <th>无人机序列号</th>
                    <td>{{ device.drone_sn }}</td>
                </tr>
                <tr>
                    <th>远程控制器序列号</th>
                    <td>{{ device.remote_sn }}</td>
                </tr>
                <tr>
                    <th>工作区ID</th>
                    <td>{{ device.workspace_id }}</td>
                </tr>
                <tr>
                    <th>设备状态</th>
                    <td>{{ device.get_status_display }}</td>
                </tr>
                <tr>
                    <th>经度</th>
                    <td>{{ device.longitude }}</td>
                </tr>
                <tr>
                    <th>纬度</th>
                    <td>{{ device.latitude }}</td>
                </tr>
            </table>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Floating Button -->
<div class="floating-button" data-toggle="modal" data-target="#addDroneModal">+</div>

<!-- Modal -->
<div class="modal fade" id="addDroneModal" tabindex="-1" role="dialog" aria-labelledby="addDroneModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addDroneModalLabel">添加无人机</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="post" action="{% url 'add_drone' %}">
                {% csrf_token %}
                <div class="modal-body">
                    <div class="form-group">
                        <label for="droneModel">无人机型号</label>
                        <select id="droneModel" name="drone_model" class="form-control" required>
                            <option value="Air 3">Air 3</option>
                            <option value="Inspire 3">Inspire 3</option>
                            <option value="Mavic 3 Classic">Mavic 3 Classic</option>
                            <option value="Mavic 3 Pro">Mavic 3 Pro</option>
                            <option value="Mini 2 SE">Mini 2 SE</option>
                            <option value="Mini 3">Mini 3</option>
                            <option value="Mini 3 Pro">Mini 3 Pro</option>
                            <option value="Mini 4 Pro">Mini 4 Pro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="droneSn">无人机序列号</label>
                        <input type="text" id="droneSn" name="drone_sn" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="remoteSn">远程控制器序列号</label>
                        <input type="text" id="remoteSn" name="remote_sn" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="workspaceId">工作区ID</label>
                        <input type="text" id="workspaceId" name="workspace_id" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="status">设备状态</label>
                        <select id="status" name="status" class="form-control" required>
                            <option value="active">在线</option>
                            <option value="inactive">离线</option>
                            <option value="maintenance">维护中</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="longitude">经度</label>
                        <input type="text" id="longitude" name="longitude" class="form-control" value="119.24547" required>
                    </div>
                    <div class="form-group">
                        <label for="latitude">纬度</label>
                        <input type="text" id="latitude" name="latitude" class="form-control" value="32.26518" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                    <button type="submit" class="btn btn-primary">提交</button>
                </div>
            </form>
        </div>
    </div>
</div>

{% endblock content %}

{% block javascripts %}
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
{% endblock javascripts %}