{% extends "layouts/base.html" %}

{% block title %} 用户信息 {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}
<style>
    .background-video {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        object-fit: cover;
    }
    .content {
        position: relative;
        z-index: 1;
        padding: 20px;
        background-color: transparent;
        border-radius: 15px; /* 圆角 */
    }
    .form-group {
        margin-bottom: 20px; /* 增加行间距 */
    }
</style>
{% endblock stylesheets %}

{% block content %}
<video autoplay muted loop class="background-video">
    <source src="{{ ASSETS_ROOT }}/img/bgv.mp4" type="video/mp4">
    Your browser does not support the video tag.
</video>

<div class="content">
    <div class="container">
        <div class="row pt-5">
            <div class="col-md-6 mt-5 offset-md-3 pt-5 mt-5">
                <div class="card">
                    <div class="card-header text-center py-4">
                        <h4 class="title">用户信息</h4>
                    </div>
                    <div class="card-body px-5 py-3">
                        <div class="row">
                            <div class="col-md-12 px-md-1">
                                <div class="form-group">
                                    <label>全名:</label>
                                    <p>{{ user.full_name }}</p>
                                </div>
                            </div>
                            <div class="col-md-12 px-md-1">
                                <div class="form-group">
                                    <label>用户名:</label>
                                    <p>{{ user.username }}</p>
                                </div>
                            </div>
                            <div class="col-md-12 px-md-1">
                                <div class="form-group">
                                    <label>邮箱:</label>
                                    <p>{{ user.email }}</p>
                                </div>
                            </div>
                            <div class="col-md-12 px-md-1">
                                <div class="form-group">
                                    <label>电话:</label>
                                    <p>{{ user.phone_number }}</p>
                                </div>
                            </div>
                            <div class="col-md-12 px-md-1">
                                <div class="form-group">
                                    <label>上次登录时间:</label>
                                    <p>{{ user.last_login }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer text-center">
                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#editModal">修改信息</button>
                        <a href="{% url 'logout' %}" class="btn btn-danger">退出登录</a>
                    </div>
                </div>
            </div>
        </div>

        <div class="row pt-5">
            <div class="col-md-6 mt-5 offset-md-3 pt-5 mt-5">
                <div class="card">
                    <div class="card-header text-center py-4">
                        <h4 class="title">云服务信息</h4>
                    </div>
                    <div class="card-body px-5 py-3">
                        <div class="row">
                            <div class="col-md-12 px-md-1">
                                <div class="form-group">
                                    <label>视频流地址:</label>
                                    <p>rtmp://1.13.23.62:1935/live/stream</p>
                                </div>
                            </div>
                            <div class="col-md-12 px-md-1">
                                <div class="form-group">
                                    <label>监测图库:</label>
                                    <p>rtmp://1.13.23.62:1935/live/stream</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 修改信息 Modal -->
<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <form method="post" action="{% url 'edit_profile' %}">
                {% csrf_token %}
                <div class="modal-header">
                    <h5 class="modal-title" id="editModalLabel">修改信息</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body px-5 py-3">
                    <div class="form-group">
                        <label for="full_name">全名</label>
                        <input type="text" class="form-control" id="full_name" name="full_name" value="{{ user.full_name }}">
                    </div>
                    <div class="form-group">
                        <label for="username">用户名</label>
                        <input type="text" class="form-control" id="username" name="username" value="{{ user.username }}">
                    </div>
                    <div class="form-group">
                        <label for="email">邮箱</label>
                        <input type="email" class="form-control" id="email" name="email" value="{{ user.email }}">
                    </div>
                    <div class="form-group">
                        <label for="phone_number">电话</label>
                        <input type="text" class="form-control" id="phone_number" name="phone_number" value="{{ user.phone_number }}">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                    <button type="submit" class="btn btn-primary">保存修改</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script>
    $('#editModal').on('shown.bs.modal', function () {
        $('#full_name').trigger('focus')
    })
</script>
{% endblock javascripts %}